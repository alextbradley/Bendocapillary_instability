function effres = bc_matching(fw, dfw, d2fw, d3fw, k, xm0,p0,A, eta)
    %cut and paste from instability calculation symbolics. These are the
    %effective boundary conditions on the drop,, including A the magnitude
    %of the perturbation.
    effres(1) = -(d2fw*eta^2*exp(4*k*xm0) - 10*d2fw*exp(2*k*(xm0 + 1)) - 3*d2fw*exp(4*k) - 4*d2fw*eta*exp(2*k*(xm0 + 1)) - 3*d2fw*exp(4*k*xm0) - 3*fw*k^2*exp(4*k*xm0) + 2*d2fw*eta*exp(4*k) - 6*dfw*k*exp(4*k) - 2*d2fw*eta^2*exp(2*k*(xm0 + 1)) - 4*d2fw*k^2*exp(2*k*(xm0 + 1)) - 8*dfw*k^2*exp(2*k*(xm0 + 1)) + 6*fw*k^2*exp(2*k*(xm0 + 1)) + 4*fw*k^4*exp(2*k*(xm0 + 1)) + d2fw*eta^2*exp(4*k) - 3*fw*k^2*exp(4*k) + 2*d2fw*eta*exp(4*k*xm0) + 6*dfw*k*exp(4*k*xm0) + 8*d2fw*k^2*xm0*exp(2*k*(xm0 + 1)) + 8*dfw*k^2*xm0*exp(2*k*(xm0 + 1)) - 8*fw*k^4*xm0*exp(2*k*(xm0 + 1)) + 2*dfw*eta^2*k*exp(4*k) + 2*eta*fw*k^2*exp(4*k) - 4*dfw*eta*k*exp(4*k*xm0) - 4*d2fw*eta^2*k^2*exp(2*k*(xm0 + 1)) - 8*dfw*eta^2*k^2*exp(2*k*(xm0 + 1)) - 2*eta^2*fw*k^2*exp(2*k*(xm0 + 1)) + 4*eta^2*fw*k^4*exp(2*k*(xm0 + 1)) - 4*d2fw*k^2*xm0^2*exp(2*k*(xm0 + 1)) + 4*fw*k^4*xm0^2*exp(2*k*(xm0 + 1)) + eta^2*fw*k^2*exp(4*k) - 2*dfw*eta^2*k*exp(4*k*xm0) + 2*eta*fw*k^2*exp(4*k*xm0) + 4*dfw*eta*k*exp(4*k) + 8*d2fw*eta*k^2*exp(2*k*(xm0 + 1)) + 16*dfw*eta*k^2*exp(2*k*(xm0 + 1)) + 12*eta*fw*k^2*exp(2*k*(xm0 + 1)) - 8*eta*fw*k^4*exp(2*k*(xm0 + 1)) + eta^2*fw*k^2*exp(4*k*xm0) - 4*d2fw*eta^2*k^2*xm0^2*exp(2*k*(xm0 + 1)) + 4*eta^2*fw*k^4*xm0^2*exp(2*k*(xm0 + 1)) - 16*d2fw*eta*k^2*xm0*exp(2*k*(xm0 + 1)) - 16*dfw*eta*k^2*xm0*exp(2*k*(xm0 + 1)) + 16*eta*fw*k^4*xm0*exp(2*k*(xm0 + 1)) + 8*d2fw*eta*k^2*xm0^2*exp(2*k*(xm0 + 1)) + 8*d2fw*eta^2*k^2*xm0*exp(2*k*(xm0 + 1)) + 8*dfw*eta^2*k^2*xm0*exp(2*k*(xm0 + 1)) - 8*eta*fw*k^4*xm0^2*exp(2*k*(xm0 + 1)) - 8*eta^2*fw*k^4*xm0*exp(2*k*(xm0 + 1)))/(10*exp(2*k*(xm0 + 1)) + 3*exp(4*k) + 3*exp(4*k*xm0) + 2*eta^2*exp(2*k*(xm0 + 1)) + 4*k^2*exp(2*k*(xm0 + 1)) - eta^2*exp(4*k) - 2*eta*exp(4*k*xm0) + 4*eta*exp(2*k*(xm0 + 1)) - eta^2*exp(4*k*xm0) - 2*eta*exp(4*k) + 4*k^2*xm0^2*exp(2*k*(xm0 + 1)) - 8*eta*k^2*exp(2*k*(xm0 + 1)) - 8*k^2*xm0*exp(2*k*(xm0 + 1)) + 4*eta^2*k^2*exp(2*k*(xm0 + 1)) + 16*eta*k^2*xm0*exp(2*k*(xm0 + 1)) - 8*eta*k^2*xm0^2*exp(2*k*(xm0 + 1)) - 8*eta^2*k^2*xm0*exp(2*k*(xm0 + 1)) + 4*eta^2*k^2*xm0^2*exp(2*k*(xm0 + 1)));
    effres(2) =(3*d3fw*exp(4*k*xm0) + 10*d3fw*exp(2*k*(xm0 + 1)) + 3*d3fw*exp(4*k) + 10*A*p0*exp(2*k*(xm0 + 1)) + 4*d3fw*eta*exp(2*k*(xm0 + 1)) - d3fw*eta^2*exp(4*k*xm0) - 9*dfw*k^2*exp(4*k*xm0) + 6*fw*k^3*exp(4*k*xm0) + 3*A*p0*exp(4*k) - 2*d3fw*eta*exp(4*k) + 2*d3fw*eta^2*exp(2*k*(xm0 + 1)) + 4*d3fw*k^2*exp(2*k*(xm0 + 1)) - 14*dfw*k^2*exp(2*k*(xm0 + 1)) - 4*dfw*k^4*exp(2*k*(xm0 + 1)) + 8*fw*k^4*exp(2*k*(xm0 + 1)) - d3fw*eta^2*exp(4*k) + 3*A*p0*exp(4*k*xm0) - 9*dfw*k^2*exp(4*k) - 6*fw*k^3*exp(4*k) - 2*d3fw*eta*exp(4*k*xm0) - A*eta^2*p0*exp(4*k) - 8*d3fw*k^2*xm0*exp(2*k*(xm0 + 1)) + 8*dfw*k^4*xm0*exp(2*k*(xm0 + 1)) - 8*fw*k^4*xm0*exp(2*k*(xm0 + 1)) - 2*A*eta*p0*exp(4*k*xm0) + 6*dfw*eta*k^2*exp(4*k) + 4*eta*fw*k^3*exp(4*k) + 4*d3fw*eta^2*k^2*exp(2*k*(xm0 + 1)) - 6*dfw*eta^2*k^2*exp(2*k*(xm0 + 1)) - 4*dfw*eta^2*k^4*exp(2*k*(xm0 + 1)) + 8*eta^2*fw*k^4*exp(2*k*(xm0 + 1)) + 4*d3fw*k^2*xm0^2*exp(2*k*(xm0 + 1)) - 4*dfw*k^4*xm0^2*exp(2*k*(xm0 + 1)) + 4*A*eta*p0*exp(2*k*(xm0 + 1)) - A*eta^2*p0*exp(4*k*xm0) + 3*dfw*eta^2*k^2*exp(4*k) + 2*eta^2*fw*k^3*exp(4*k) + 6*dfw*eta*k^2*exp(4*k*xm0) - 4*eta*fw*k^3*exp(4*k*xm0) - 2*A*eta*p0*exp(4*k) + 2*A*eta^2*p0*exp(2*k*(xm0 + 1)) + 4*A*k^2*p0*exp(2*k*(xm0 + 1)) - 8*d3fw*eta*k^2*exp(2*k*(xm0 + 1)) + 4*dfw*eta*k^2*exp(2*k*(xm0 + 1)) + 8*dfw*eta*k^4*exp(2*k*(xm0 + 1)) + 3*dfw*eta^2*k^2*exp(4*k*xm0) - 16*eta*fw*k^4*exp(2*k*(xm0 + 1)) - 2*eta^2*fw*k^3*exp(4*k*xm0) + 4*d3fw*eta^2*k^2*xm0^2*exp(2*k*(xm0 + 1)) - 4*dfw*eta^2*k^4*xm0^2*exp(2*k*(xm0 + 1)) - 8*A*eta*k^2*p0*exp(2*k*(xm0 + 1)) - 8*A*k^2*p0*xm0*exp(2*k*(xm0 + 1)) + 16*d3fw*eta*k^2*xm0*exp(2*k*(xm0 + 1)) - 16*dfw*eta*k^4*xm0*exp(2*k*(xm0 + 1)) + 16*eta*fw*k^4*xm0*exp(2*k*(xm0 + 1)) + 4*A*eta^2*k^2*p0*exp(2*k*(xm0 + 1)) + 4*A*k^2*p0*xm0^2*exp(2*k*(xm0 + 1)) - 8*d3fw*eta*k^2*xm0^2*exp(2*k*(xm0 + 1)) - 8*d3fw*eta^2*k^2*xm0*exp(2*k*(xm0 + 1)) + 8*dfw*eta*k^4*xm0^2*exp(2*k*(xm0 + 1)) + 8*dfw*eta^2*k^4*xm0*exp(2*k*(xm0 + 1)) - 8*eta^2*fw*k^4*xm0*exp(2*k*(xm0 + 1)) - 8*A*eta*k^2*p0*xm0^2*exp(2*k*(xm0 + 1)) - 8*A*eta^2*k^2*p0*xm0*exp(2*k*(xm0 + 1)) + 4*A*eta^2*k^2*p0*xm0^2*exp(2*k*(xm0 + 1)) + 16*A*eta*k^2*p0*xm0*exp(2*k*(xm0 + 1)))/(10*exp(2*k*(xm0 + 1)) + 3*exp(4*k) + 3*exp(4*k*xm0) + 2*eta^2*exp(2*k*(xm0 + 1)) + 4*k^2*exp(2*k*(xm0 + 1)) - eta^2*exp(4*k) - 2*eta*exp(4*k*xm0) + 4*eta*exp(2*k*(xm0 + 1)) - eta^2*exp(4*k*xm0) - 2*eta*exp(4*k) + 4*k^2*xm0^2*exp(2*k*(xm0 + 1)) - 8*eta*k^2*exp(2*k*(xm0 + 1)) - 8*k^2*xm0*exp(2*k*(xm0 + 1)) + 4*eta^2*k^2*exp(2*k*(xm0 + 1)) + 16*eta*k^2*xm0*exp(2*k*(xm0 + 1)) - 8*eta*k^2*xm0^2*exp(2*k*(xm0 + 1)) - 8*eta^2*k^2*xm0*exp(2*k*(xm0 + 1)) + 4*eta^2*k^2*xm0^2*exp(2*k*(xm0 + 1)));
end